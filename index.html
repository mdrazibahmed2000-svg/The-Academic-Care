<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Care - Tuition Management</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- IMPORTANT: Paste the content of 'tuition_styles.css' into the <style> block below to apply styling -->
    <style>
        /* CSS CONTENT GOES HERE */
    </style>
</head>
<body>

<div id="loading-overlay" class="loading-overlay">Initializing App...</div>

<!-- Login Page -->
<div id="login-page" class="page flex flex-col space-y-4 hidden">
    <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">Academic Care</h2>
    <p class="text-sm text-center text-gray-500">Tuition Fee Management</p>
    <input type="text" id="studentIdInput" placeholder="Enter Student ID (e.g., S1001) or 'admin'"
           class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00a896] focus:border-[#00a896]">
    <button onclick="login()"
            class="bg-[#00a896] hover:bg-[#008f80] text-white font-semibold p-3 rounded-lg shadow-md transition duration-200">
        Login
    </button>
    <button onclick="showRegister()"
            class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold p-3 rounded-lg transition duration-200">
        New Student? Register
    </button>
    <p id="loginError" class="error text-center"></p>
</div>

<!-- Registration Page -->
<div id="register-page" class="page flex flex-col space-y-4 hidden">
    <h2 class="text-2xl font-semibold text-gray-800">Student Registration</h2>
    <form id="registerForm" class="flex flex-col space-y-3" onsubmit="event.preventDefault(); registerStudent();">
        <input type="text" id="regName" placeholder="Full Name" required
               class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00a896] focus:border-[#00a896]">
        <input type="number" id="regClass" placeholder="Class (e.g., 10)" required
               class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00a896] focus:border-[#00a896]">
        <input type="number" id="regRoll" placeholder="Roll Number (e.g., 5)" required
               class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00a896] focus:border-[#00a896]">
        <input type="text" id="regGuardian" placeholder="Guardian Mobile No (10 digits)" required
               class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00a896] focus:border-[#00a896]">
        <button type="submit"
                class="bg-[#00a896] hover:bg-[#008f80] text-white font-semibold p-3 rounded-lg shadow-md transition duration-200 mt-2">
            Submit for Approval
        </button>
        <p id="registerMessage" class="text-sm text-center text-gray-600"></p>
    </form>
    <button onclick="showLogin()"
            class="text-sm text-gray-600 hover:text-[#00a896] transition duration-200">
        &larr; Back to Login
    </button>
</div>

<!-- Student Dashboard -->
<div id="dashboard" class="page flex flex-col space-y-6 hidden">
    <div class="flex justify-between items-center">
        <h2 class="text-2xl font-bold text-[#00a896]">Welcome, <span id="studentName"></span></h2>
        <button onclick="logout()" class="text-sm text-red-500 hover:text-red-700">Logout</button>
    </div>
    <div class="p-4 bg-gray-50 rounded-lg">
        <p class="text-sm font-medium text-gray-600 mb-2">Your ID: <span class="font-mono text-xs p-1 bg-gray-200 rounded" id="currentStudentId"></span></p>
        <h3 class="text-lg font-semibold text-gray-700 mb-3">Monthly Fees Status</h3>
        <div id="studentFees" class="space-y-2">
            <!-- Fee status will be injected here -->
        </div>
    </div>
</div>

<!-- Admin Panel -->
<div id="admin-panel" class="page flex flex-col space-y-6 hidden">
    <div class="flex justify-between items-center">
        <h2 class="text-2xl font-bold text-[#00a896]">Admin Panel</h2>
        <button onclick="logout()" class="text-sm text-red-500 hover:text-red-700">Logout</button>
    </div>

    <div class="border-t border-gray-200 pt-4">
        <h3 class="text-xl font-semibold mb-2 text-gray-700">Pending Approvals</h3>
        <ul id="pendingStudents" class="space-y-3">
            <!-- Pending students will be injected here -->
            <li class="text-gray-500 text-sm italic" id="noPending">No pending students.</li>
        </ul>
    </div>

    <div class="border-t border-gray-200 pt-4">
        <h3 class="text-xl font-semibold mb-2 text-gray-700">Approved Students</h3>
        <select id="selectStudentFees" onchange="loadStudentFees(this.value)"
                class="w-full p-3 border border-gray-300 rounded-lg mb-4 focus:ring-2 focus:ring-[#00a896] focus:border-[#00a896]">
            <option value="" disabled selected>Select student for fee management</option>
        </select>
        <div id="monthlyFeesContainer" class="p-3 bg-gray-50 rounded-lg">
            <h4 class="text-lg font-medium text-gray-700 mb-2">Fee Records for: <span id="selectedStudentName"></span></h4>
            <div id="monthlyFees" class="space-y-2 text-sm">
                <p class="text-gray-500">Select a student above to view/manage fees.</p>
                <!-- Monthly fee records will be injected here -->
            </div>
        </div>
    </div>
</div>

<!-- Firebase SDK Imports (Modern v11+) and Application Logic -->
<script type="module">
    // FIREBASE IMPORTS MUST REMAIN HERE TO WORK CORRECTLY
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signOut, setPersistence, browserSessionPersistence } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, collection, query, where, getDocs, setDoc, doc, onSnapshot, addDoc, updateDoc, deleteDoc, getDoc, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // IMPORTANT: Paste the content of 'tuition_logic.js' below this line to add functionality

    // JAVASCRIPT LOGIC GOES HERE

</script>

</body>
</html>

